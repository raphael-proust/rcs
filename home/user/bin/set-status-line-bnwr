#!/bin/dash

STATUSLINE="$(status-line-bnwr)"

WMNAME="$(wmname 2>/dev/null)"
if [ "$?" -eq "0" ]
then
  case "$WMNAME" in
    dwm)
      xsetroot -name "$STATUSLINE"
      ;;
    wmii)
      wmiir write /rbar/status "$STATUSLINE"
      ;;
  esac
fi

STATUSPIPESDIR="/tmp/dvtm-status-pipes"
if [ -d $STATUSPIPESDIR ]
then
  for i in $(ls $STATUSPIPESDIR |grep "dvtm-status.[[:digit:]]\+")
  do
    echo "$STATUSLINE" > $STATUSPIPESDIR/$i
  done
fi

